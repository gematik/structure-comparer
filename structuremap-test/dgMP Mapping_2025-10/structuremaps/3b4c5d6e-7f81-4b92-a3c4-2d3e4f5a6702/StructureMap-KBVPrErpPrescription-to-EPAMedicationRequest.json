{
  "resourceType": "StructureMap",
  "id": "KBVPrErpPrescriptionMap",
  "url": "https://gematik.de/fhir/structure-comparer/StructureMap/KBVPrErpPrescriptionMap",
  "name": "KBVPrErpPrescriptionMap",
  "status": "active",
  "version": "1.0",
  "date": "2025-12-12",
  "description": "Auto-generated StructureMap for KBV_PR_ERP_Prescription|1.3.2 -> EPAMedicationRequest|1.0.6-2",
  "structure": [
    {
      "url": "https://fhir.kbv.de/StructureDefinition/KBV_PR_ERP_Prescription",
      "mode": "source",
      "alias": "KBVPRERPPrescription"
    },
    {
      "url": "https://gematik.de/fhir/epa-medication/StructureDefinition/epa-medication-request",
      "mode": "target",
      "alias": "EPAMedicationRequest"
    }
  ],
  "group": [
    {
      "name": "KBVPrErpPrescriptionMap",
      "typeMode": "types",
      "documentation": "Mapping generated for KBV_PR_ERP_Prescription|1.3.2 -> EPAMedicationRequest|1.0.6-2",
      "input": [
        {
          "name": "KBVPRERPPrescription",
          "type": "KBVPRERPPrescription",
          "mode": "source"
        },
        {
          "name": "EPAMedicationRequest",
          "type": "EPAMedicationRequest",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "MedicationRequestExtensionMehrfachverordnungacff1e61",
          "documentation": "Copied to 'MedicationRequest.extension:multiplePrescription'",
          "source": [
            {
              "context": "KBVPRERPPrescription",
              "element": "extension",
              "variable": "srcKBVPRERPPrescriptionExtensionMehrfachverordnungc7120a1c",
              "condition": "url = 'https://fhir.kbv.de/StructureDefinition/KBV_EX_ERP_Multiple_Prescription' and url != 'Kennzeichen' and url != 'ID' and url != 'Nummerierung' and url != 'Zeitraum' and url = 'https://fhir.kbv.de/StructureDefinition/KBV_EX_ERP_Multiple_Prescription'"
            }
          ],
          "target": [
            {
              "context": "EPAMedicationRequest",
              "contextType": "variable",
              "element": "extension",
              "variable": "tgtEPAMedicationRequestExtensionMultipleprescriptionb8edbb86",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Extension"
                }
              ]
            },
            {
              "context": "tgtEPAMedicationRequestExtensionMultipleprescriptionb8edbb86",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "https://gematik.de/fhir/epa-medication/StructureDefinition/multiple-prescription-extension"
                }
              ]
            }
          ]
        },
        {
          "name": "MedicationRequestExtensionSer9195c707",
          "documentation": "Copied to 'MedicationRequest.extension:isBvg'",
          "source": [
            {
              "context": "KBVPRERPPrescription",
              "element": "extension",
              "variable": "srcKBVPRERPPrescriptionExtensionSere0662047",
              "condition": "url = 'https://fhir.kbv.de/StructureDefinition/KBV_EX_FOR_SER' and url = 'https://fhir.kbv.de/StructureDefinition/KBV_EX_FOR_SER'"
            }
          ],
          "target": [
            {
              "context": "EPAMedicationRequest",
              "contextType": "variable",
              "element": "extension",
              "variable": "tgtEPAMedicationRequestExtensionIsbvg91362b1c",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Extension"
                }
              ]
            },
            {
              "context": "tgtEPAMedicationRequestExtensionIsbvg91362b1c",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "https://gematik.de/fhir/epa-medication/StructureDefinition/indicator-bvg-extension"
                }
              ]
            }
          ]
        },
        {
          "name": "MedicationRequestExtensionIsbvgUrl7791daf6",
          "target": [
            {
              "context": "EPAMedicationRequest",
              "element": "extension",
              "variable": "tgtEPAMedicationRequestExtensionIsbvg91362b1c",
              "contextType": "variable",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "https://gematik.de/fhir/epa-medication/StructureDefinition/indicator-bvg-extension"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "MedicationRequestExtensionIsbvgUrl7791daf6",
              "documentation": "Fixed value 'https://gematik.de/fhir/epa-medication/StructureDefinition/indicator-bvg-extension' | Auto-detected fixed value from target profile",
              "source": [
                {
                  "context": "KBVPRERPPrescription"
                }
              ],
              "target": [
                {
                  "context": "tgtEPAMedicationRequestExtensionIsbvg91362b1c",
                  "contextType": "variable",
                  "element": "url",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "https://gematik.de/fhir/epa-medication/StructureDefinition/indicator-bvg-extension"
                    }
                  ]
                }
              ]
            }
          ],
          "source": [
            {
              "context": "KBVPRERPPrescription"
            }
          ]
        },
        {
          "name": "MedicationRequestExtensionMultipleprescriptionUrlc4501787",
          "target": [
            {
              "context": "EPAMedicationRequest",
              "element": "extension",
              "variable": "tgtEPAMedicationRequestExtensionMultipleprescriptionb8edbb86",
              "contextType": "variable",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "https://gematik.de/fhir/epa-medication/StructureDefinition/multiple-prescription-extension"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "MedicationRequestExtensionMultipleprescriptionUrlc4501787",
              "documentation": "Fixed value 'https://gematik.de/fhir/epa-medication/StructureDefinition/multiple-prescription-extension' | Auto-detected fixed value from target profile",
              "source": [
                {
                  "context": "KBVPRERPPrescription"
                }
              ],
              "target": [
                {
                  "context": "tgtEPAMedicationRequestExtensionMultipleprescriptionb8edbb86",
                  "contextType": "variable",
                  "element": "url",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "https://gematik.de/fhir/epa-medication/StructureDefinition/multiple-prescription-extension"
                    }
                  ]
                }
              ]
            }
          ],
          "source": [
            {
              "context": "KBVPRERPPrescription"
            }
          ]
        },
        {
          "name": "MedicationRequestInsurance8b499ebd",
          "documentation": "Copied to 'MedicationRequest.insurance'",
          "source": [
            {
              "context": "KBVPRERPPrescription",
              "element": "insurance",
              "variable": "srcKBVPRERPPrescriptionInsurance97877d04"
            }
          ],
          "target": [
            {
              "context": "EPAMedicationRequest",
              "contextType": "variable",
              "element": "insurance",
              "variable": "tgtEPAMedicationRequestInsurance9fe43701",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ]
        },
        {
          "name": "MedicationRequestMetaProfile56c958a8",
          "target": [
            {
              "context": "EPAMedicationRequest",
              "element": "meta",
              "variable": "tgtEPAMedicationRequestMeta55fad1b0",
              "contextType": "variable"
            }
          ],
          "rule": [
            {
              "name": "MedicationRequestMetaProfile56c958a8",
              "documentation": "Fixed value 'https://gematik.de/fhir/epa-medication/StructureDefinition/epa-medication-request'",
              "source": [
                {
                  "context": "KBVPRERPPrescription"
                }
              ],
              "target": [
                {
                  "context": "tgtEPAMedicationRequestMeta55fad1b0",
                  "contextType": "variable",
                  "element": "profile",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "https://gematik.de/fhir/epa-medication/StructureDefinition/epa-medication-request"
                    }
                  ]
                }
              ]
            }
          ],
          "source": [
            {
              "context": "KBVPRERPPrescription"
            }
          ]
        },
        {
          "name": "MedicationRequestRequester3e498d80",
          "documentation": "Copied to 'MedicationRequest.requester'",
          "source": [
            {
              "context": "KBVPRERPPrescription",
              "element": "requester",
              "variable": "srcKBVPRERPPrescriptionRequester66a1f0a5"
            }
          ],
          "target": [
            {
              "context": "EPAMedicationRequest",
              "contextType": "variable",
              "element": "requester",
              "variable": "tgtEPAMedicationRequestRequester76629bb4",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "srcKBVPRERPPrescriptionRequester66a1f0a5"
                }
              ]
            }
          ]
        },
        {
          "name": "MedicationRequestSubjectfe47ad58",
          "documentation": "Copied to 'MedicationRequest.subject'",
          "source": [
            {
              "context": "KBVPRERPPrescription",
              "element": "subject",
              "variable": "srcKBVPRERPPrescriptionSubjectb79dbef0"
            }
          ],
          "target": [
            {
              "context": "EPAMedicationRequest",
              "contextType": "variable",
              "element": "subject",
              "variable": "tgtEPAMedicationRequestSubject8a8bf8a9",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "srcKBVPRERPPrescriptionSubjectb79dbef0"
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}