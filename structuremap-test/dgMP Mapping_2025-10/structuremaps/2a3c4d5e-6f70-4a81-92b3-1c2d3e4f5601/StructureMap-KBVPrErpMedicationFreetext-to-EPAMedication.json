{
  "resourceType": "StructureMap",
  "id": "KBVPrErpMedicationFreetextMap",
  "url": "https://gematik.de/fhir/structure-comparer/StructureMap/KBVPrErpMedicationFreetextMap",
  "name": "KBVPrErpMedicationFreetextMap",
  "status": "active",
  "version": "1.1",
  "date": "2025-12-12",
  "description": "Auto-generated StructureMap for KBV_PR_ERP_Medication_Compounding|1.3.2, KBV_PR_ERP_Medication_FreeText|1.3.2, KBV_PR_ERP_Medication_Ingredient|1.3.2, KBV_PR_ERP_Medication_PZN|1.3.2 -> EPAMedication|1.0.6-2",
  "structure": [
    {
      "url": "https://fhir.kbv.de/StructureDefinition/KBV_PR_ERP_Medication_FreeText",
      "mode": "source",
      "alias": "KBVPRERPMedicationCompounding"
    },
    {
      "url": "https://gematik.de/fhir/epa-medication/StructureDefinition/epa-medication",
      "mode": "target",
      "alias": "EPAMedication"
    }
  ],
  "group": [
    {
      "name": "KBVPrErpMedicationFreetextMap",
      "typeMode": "types",
      "documentation": "Mapping generated for KBV_PR_ERP_Medication_Compounding|1.3.2, KBV_PR_ERP_Medication_FreeText|1.3.2, KBV_PR_ERP_Medication_Ingredient|1.3.2, KBV_PR_ERP_Medication_PZN|1.3.2 -> EPAMedication|1.0.6-2",
      "input": [
        {
          "name": "KBVPRERPMedicationCompounding",
          "type": "Medication",
          "mode": "source"
        },
        {
          "name": "EPAMedication",
          "type": "Medication",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "MedicationBatch235a7d75",
          "documentation": "Copied to 'Medication.batch'",
          "source": [
            {
              "context": "KBVPRERPMedicationCompounding",
              "element": "batch",
              "variable": "srcKBVPRERPMedicationCompoundingBatch76856f17"
            }
          ],
          "target": [
            {
              "context": "EPAMedication",
              "contextType": "variable",
              "element": "batch",
              "variable": "tgtEPAMedicationBatch90ce2ac1",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "srcKBVPRERPMedicationCompoundingBatch76856f17"
                }
              ]
            }
          ]
        },
        {
          "name": "MedicationCoded98e85bf",
          "documentation": "Automatic copy",
          "source": [
            {
              "context": "KBVPRERPMedicationCompounding",
              "element": "code",
              "variable": "srcKBVPRERPMedicationCompoundingCode19fc48cb"
            }
          ],
          "target": [
            {
              "context": "EPAMedication",
              "contextType": "variable",
              "element": "code",
              "variable": "tgtEPAMedicationCodea6251800",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "srcKBVPRERPMedicationCompoundingCode19fc48cb"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "MedicationCodeCoding9b1e4117",
              "source": [
                {
                  "context": "srcKBVPRERPMedicationCompoundingCode19fc48cb",
                  "variable": "srcMedicationCodeCoding9b1e4117",
                  "element": "coding"
                }
              ],
              "target": [
                {
                  "context": "tgtEPAMedicationCodea6251800",
                  "contextType": "variable",
                  "element": "coding",
                  "variable": "tgtMedicationCodeCoding9b1e4117",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueId": "srcMedicationCodeCoding9b1e4117"
                    }
                  ]
                }
              ],
              "documentation": "Copied to 'Medication.code.coding'"
            },
            {
              "name": "MedicationCodeText75c8453e",
              "source": [
                {
                  "context": "srcKBVPRERPMedicationCompoundingCode19fc48cb",
                  "variable": "srcMedicationCodeText75c8453e",
                  "element": "text"
                }
              ],
              "target": [
                {
                  "context": "tgtEPAMedicationCodea6251800",
                  "contextType": "variable",
                  "element": "text",
                  "variable": "tgtMedicationCodeText75c8453e",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueId": "srcMedicationCodeText75c8453e"
                    }
                  ]
                }
              ],
              "documentation": "Automatic copy"
            }
          ]
        },
        {
          "name": "MedicationExtension9f8d5121",
          "documentation": "Automatic copy",
          "source": [
            {
              "context": "KBVPRERPMedicationCompounding",
              "element": "extension",
              "variable": "srcKBVPRERPMedicationCompoundingExtension3e44d0a1",
              "condition": "url != 'https://fhir.kbv.de/StructureDefinition/KBV_EX_ERP_Medication_Category' and url != 'https://fhir.kbv.de/StructureDefinition/KBV_EX_Base_Medication_Type' and url != 'http://fhir.de/StructureDefinition/normgroesse' and url != 'https://fhir.kbv.de/StructureDefinition/KBV_EX_ERP_Medication_Packaging' and url != 'https://fhir.kbv.de/StructureDefinition/KBV_EX_ERP_Medication_Vaccine' and url != 'https://fhir.kbv.de/StructureDefinition/KBV_EX_ERP_Medication_CompoundingInstruction'"
            }
          ],
          "target": [
            {
              "context": "EPAMedication",
              "contextType": "variable",
              "element": "extension",
              "variable": "tgtEPAMedicationExtension59cd7688",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "srcKBVPRERPMedicationCompoundingExtension3e44d0a1"
                }
              ]
            }
          ]
        },
        {
          "name": "MedicationExtensionArzneimittelkategoriedd7d37b4",
          "documentation": "Copied to 'Medication.extension:drugCategory'",
          "source": [
            {
              "context": "KBVPRERPMedicationCompounding",
              "element": "extension",
              "variable": "srcKBVPRERPMedicationCompoundingExtensionArzneimittelkatego82a24",
              "condition": "url = 'https://fhir.kbv.de/StructureDefinition/KBV_EX_ERP_Medication_Category' and url = 'https://fhir.kbv.de/StructureDefinition/KBV_EX_ERP_Medication_Category'"
            }
          ],
          "target": [
            {
              "context": "EPAMedication",
              "contextType": "variable",
              "element": "extension",
              "variable": "tgtEPAMedicationExtensionDrugcategory059b5c6b",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "srcKBVPRERPMedicationCompoundingExtensionArzneimittelkatego82a24"
                }
              ]
            },
            {
              "context": "tgtEPAMedicationExtensionDrugcategory059b5c6b",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "https://gematik.de/fhir/epa-medication/StructureDefinition/drug-category-extension"
                }
              ]
            }
          ]
        },
        {
          "name": "MedicationExtensionImpfstoff485a90ab",
          "documentation": "Copied to 'Medication.extension:isVaccine'",
          "source": [
            {
              "context": "KBVPRERPMedicationCompounding",
              "element": "extension",
              "variable": "srcKBVPRERPMedicationCompoundingExtensionImpfstoffb07a0850",
              "condition": "url = 'https://fhir.kbv.de/StructureDefinition/KBV_EX_ERP_Medication_Vaccine' and url = 'https://fhir.kbv.de/StructureDefinition/KBV_EX_ERP_Medication_Vaccine'"
            }
          ],
          "target": [
            {
              "context": "EPAMedication",
              "contextType": "variable",
              "element": "extension",
              "variable": "tgtEPAMedicationExtensionIsvaccinea7742b5a",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Extension"
                }
              ]
            },
            {
              "context": "tgtEPAMedicationExtensionIsvaccinea7742b5a",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "https://gematik.de/fhir/epa-medication/StructureDefinition/medication-id-vaccine-extension"
                }
              ]
            }
          ]
        },
        {
          "name": "MedicationForm5a0bbd5f",
          "documentation": "Copied to 'Medication.form'",
          "source": [
            {
              "context": "KBVPRERPMedicationCompounding",
              "element": "form",
              "variable": "srcKBVPRERPMedicationCompoundingFormc5146e0b"
            }
          ],
          "target": [
            {
              "context": "EPAMedication",
              "contextType": "variable",
              "element": "form",
              "variable": "tgtEPAMedicationForm691ed321",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "srcKBVPRERPMedicationCompoundingFormc5146e0b"
                }
              ]
            }
          ]
        },
        {
          "name": "MedicationMetaf9f176bc",
          "documentation": "Automatic copy",
          "source": [
            {
              "context": "KBVPRERPMedicationCompounding",
              "element": "meta",
              "variable": "srcKBVPRERPMedicationCompoundingMeta80467efb"
            }
          ],
          "target": [
            {
              "context": "EPAMedication",
              "contextType": "variable",
              "element": "meta",
              "variable": "tgtEPAMedicationMeta8591b307",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "srcKBVPRERPMedicationCompoundingMeta80467efb"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "MedicationMetaProfile399adfc6",
              "source": [
                {
                  "context": "srcKBVPRERPMedicationCompoundingMeta80467efb",
                  "variable": "srcMedicationMetaProfile399adfc6"
                }
              ],
              "target": [
                {
                  "context": "tgtEPAMedicationMeta8591b307",
                  "contextType": "variable",
                  "element": "profile",
                  "variable": "tgtMedicationMetaProfile399adfc6",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "https://gematik.de/fhir/epa-medication/StructureDefinition/epa-medication"
                    }
                  ]
                }
              ],
              "documentation": "Fixed value 'https://gematik.de/fhir/epa-medication/StructureDefinition/epa-medication'"
            }
          ]
        }
      ]
    }
  ]
}